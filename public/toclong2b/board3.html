<!DOCTYPE html>
<html lang="en">

<head>
  <title>Toclong II St.</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.2/html2canvas.min.js"></script>
  <script src="https://code.highcharts.com/highcharts.js"></script>
  <script defer src="/__/firebase/9.22.1/firebase-app-compat.js"></script>
  <!-- include only the Firebase features as you need -->
  <script defer src="/__/firebase/9.22.1/firebase-database-compat.js"></script>
  <style>
    .hover-link {
      position: relative;
      /* Set the parent element to relative position */
    }

    .hover-link::before {
      content: "Click for more tips";
      /* Set the text content */
      position: absolute;
      /* Set the pseudo-element to absolute position */
      top: -22%;
      /* Set the distance above the element */
      left: 100%;
      transform: translateX(-50%);
      /* Center the box horizontally */
      width: 125px;
      /* Set the width of the box */
      background-color: #ececec;
      border-color: rgb(133, 13, 13);
      border-width: 20px;
      color: rgb(70, 70, 70);
      /* Set the background color of the box */
      border-radius: 5px;
      /* Set the border radius for smooth corners */
      padding: 5px;
      /* Add padding inside the box */
      font-size: 12px;
      /* Set the font size of the text */
      text-align: center;
      /* Center the text horizontally */
      opacity: 0;
      /* Set initial opacity to 0 */
      transition: opacity 0.3s ease-in-out;
      /* Add a transition effect for smooth fade-in/out */
    }

    .hover-link:hover::before {
      opacity: 1;
      /* Set opacity to 1 on hover */
    }

    .card-title-wrapper {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* Custom styles */
    body {
      background-color: #ffffff;
      color: #343a40;
    }

    .navbar {
      background-color: #ffffff;
      border-bottom: 1px solid #dee2e6;
    }

    .navbar-nav .nav-link {
      color: #343a40;
      border-left: 1px solid #dee2e6;
      border-right: 1px solid #dee2e6;
      transition: background-color 0.3s;
      font-size: 18px;
      /* Adjust the font size as needed */
      padding: 10px 25px;
      /* Adjust the padding as needed */
      position: relative;
      /* Add this line */
    }

    .navbar-nav .nav-link:before {
      content: '';
      position: absolute;
      top: 0;
      bottom: 0;
      left: -9px;
      /* Adjust the position as needed */
      width: 1px;
      /* Adjust the width as needed */
      background-color: #dee2e6;
    }

    .navbar-nav .nav-link:hover,
    .navbar-nav .nav-link.active {
      background-color: #f8f9fa;
    }

    .navbar-nav .nav-link:hover {
      background-color: #f8f9fa;
    }

    .navbar-nav .nav-link:first-child {
      border-left: none;
    }

    .navbar-nav .nav-link:last-child {
      border-right: none;
    }

    .navbar-nav .nav-link.active {
      background-color: #f0f0f0;
    }

    .navbar-nav .nav-link:not(.active):hover {
      background-color: #f1f1f1;
    }
  </style>
</head>

<body>
  <nav class="navbar navbar-expand-lg shadow"
    style="background-image: linear-gradient(to bottom right, #0083B0, #00B4DB); padding-top: 20px; padding-bottom: 20px;">
    <div class="container-fluid">
      <a class="navbar-brand ps-3 mx-auto" style="color:#FFFFFF; font-size: 30px;" href="/">Real-Time Flood Monitoring
        and Road Flood Warning System for Barangay Toclong 2B Imus Cavite</a>
    </div>
  </nav>
  <!-- Navbar2 -->
  <nav class="navbar navbar-expand-md navbar-light mb-3">
    <div class="container">
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
        aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse justify-content-center" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item px-2">
            <a class="nav-link" href="/">Home</a>
          </li>
          <li class="nav-item px-2">
            <a class="nav-link" href="/toclong2b/select-area.html">All</a>
          </li>
          <li class="nav-item px-2">
            <a class="nav-link active" aria-current="page" href="/toclong2b/board3.html">Toclong II St.</a>
          </li>
          <li class="nav-item px-2">
            <a class="nav-link" href="/toclong2b/board2.html">E.Villanueva Ave.</a>
          </li>
          <li class="nav-item px-2">
            <a class="nav-link" href="/toclong2b/board1.html">Tributary River</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <!-- Board 3 -->
  <div class="container-fluid pt-1">
    <!-- Board 3 -->

    <div class="container-fluid">
      <div class="ps-4 mb-3">
        <div class="row">
          <div class="col-6">
            <h1>Toclong II St.</h1>

          </div>
          <div class="col-6  d-flex justify-content-end">
            <button id="download-btn" class="btn btn-primary btn-lg">Generate Report</button>
            <span id="timeSpan"
              class="badge bg-primary text-white fs-5 d-flex align-items-center justify-content-center ms-auto"></span>
          </div>

        </div>
      </div>
      <!-- Street x Map -->
      <div class="row">
        <div class="col-lg-6 col-12 col">
          <div class="row">
            <div class="col-lg-10 col-10 px-0">
              <div class="card-header text-center">Alert Level</div>
              <div class="card rect1 " style="height: 150px;">
                <div class="card-body">
                  <div class="card-title-wrapper">
                    <h1 id="na3" class="card-title text-center text-street-name">PATV</h1>
                    <a href="/info.html" class="hover-link">
                      <span class="card-text text-center text-street-name">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                          class="bi bi-info-circle" viewBox="0 0 16 16">
                          <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
                          <path
                            d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z" />
                        </svg>
                      </span>
                    </a>
                  </div>
                  <h5 id="nb3" class="card-text text-center text-street-name">Passable</h5>
                </div>
              </div>
            </div>
            <div class="col-lg-2 col-2 px-0">
              <div class="card-header text-center">Info</div>
              <div class="card rect1 " style="height: 150px;">
                <div class="card-body">
                  <h5 class="card-text text-center text-street-name">Board 3</h5>
                  <h5 class="card-text text-center text-street-name">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                      class="bi bi-battery-full" viewBox="0 0 16 16">
                      <path d="M2 6h10v4H2V6z" />
                      <path
                        d="M2 4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2H2zm10 1a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1h10zm4 3a1.5 1.5 0 0 1-1.5 1.5v-3A1.5 1.5 0 0 1 16 8z" />
                    </svg>
                    <span id="board3Voltage"></span>%
                  </h5>
                </div>
              </div>
            </div>

            <!--div class="col-lg-6 col-6 px-0"></div>-->
            <!-- <div class="col-lg-6 col-6 px-0"></div> -->
          </div>
          <div class="row">
            <div class="col-lg-6 col-6 px-0">
              <div class="card rect3 ">
                <div class="card-body">
                  <div>
                    <h5 class="card-title text-center text-water-level">Water Level (Ultrasonic) </h5>
                  </div>
                  <div class="text-w text-center">
                    <p>
                      <span class="reading">
                        <span id="w3" class="fs-1 fw-bold"></span> cm </span>
                    </p>
                    <p class="packet">
                  </div>
                </div>
              </div>
            </div>
            <div class="col-lg-6 col-6 px-0">
              <div class="card rect4 ">
                <div class="card-body">
                  <div>
                    <h5 class="card-title text-center text-pressure">Water Level (Pressure)</h5>
                  </div>
                  <div class="text-p text-center">
                    <p>
                      <span class="reading">
                        <span id="p3" class="fs-1 fw-bold"></span> cm </span>
                    </p>
                    <p class="packet">
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-lg-6 col-6 px-0">
              <div class="card rect5 ">
                <div class="card-body">
                  <div>
                    <h5 class="card-title text-center text-temperature">Temperature</h5>
                  </div>
                  <div class="text-t text-center">
                    <p>
                      <span class="reading">
                        <span id="t3" class="fs-1 fw-bold"></span> &deg;C </span>
                    </p>
                    <p class="packet">
                  </div>
                </div>
              </div>
            </div>
            <div class="col-lg-6 col-6 px-0">
              <div class="card rect6 ">
                <div class="card-body">
                  <div>
                    <h5 class="card-title text-center text-temperature">Humidity</h5>
                  </div>
                  <div class="text-h text-center">
                    <p>
                      <span class="reading">
                        <span id="h3" class="fs-1 fw-bold"></span> &percnt; </span>
                    </p>
                    <p class="packet">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-lg-6 col-12 parent d-flex justify-content-center mt-2 col">
          <div id="map" class="col-lg-6" style="height: 450px; width: 100%;"></div>
        </div>
      </div>
      <!-- WaterLevel -->
      <div class="row waterlevel-graph">
        <div class="col-lg-6 col-6">
          <div id="chart-pressure3" class="container-fluid mt-5"></div>
        </div>
        <div class="col-lg-6 col-6">
          <div id="chart-level3" class="container-fluid mt-5"></div>
        </div>
      </div>
      <!-- TempHumid -->
      <div class="row temphum-graph">
        <div class="col-lg-6 col-6">
          <div id="chart-temperature3" class="container-fluid mt-5"></div>
        </div>
        <div class="col-lg-6 col-6">
          <div id="chart-humidity3" class="container-fluid mt-5"></div>
        </div>
      </div>
      <div class="row">
        <div class="ps-4 mb-3">
          <h1>History</h1>
        </div>
        <div class="card">
          <div class="card-body">
            <h5 class="card-title">Sensor Data</h5>
            <table id="dataTable" class="table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Temperature</th>
                  <th>Humidity</th>
                  <th>Water Level</th>
                  <th>Pressure</th>
                  <th>Battery</th>
                  <th>Reading ID</th>
                </tr>
              </thead>
              <tbody id="dataBody">
                <!-- Data rows will be inserted here -->
              </tbody>
            </table>
          </div>
        </div>

      </div>
    </div>
  </div>
</body>
<script>

  function fetchData() {
    fetch('/data.txt')
      .then(response => response.text())
      .then(data => {
        console.log("data:");
        console.log(data);
        // data = data.replace(/-/g, ','); // Replace dashes with commas
        console.log("data:");
        console.log(data);

        // Replace dashes with valid JSON numbers (remove the commas)
        let replacedData = data.replace(/-/g, '');

        const jsonDataArray = replacedData.split("}{");

        // Add square brackets and commas to create valid JSON array
        let cleanedData = "[" + jsonDataArray.join("},{") + "]";

        console.log("cleanedData:");
        console.log(cleanedData);



        // Parse the cleaned data into a JavaScript object
        const parsedData = JSON.parse(cleanedData);

        console.log("parsedData:");
        console.log(parsedData);
        // Find the table body element
        const tableBody = document.getElementById('dataBody');

        // Loop through the parsed data and create table rows
        parsedData.forEach(item => {
          const row = document.createElement('tr');

          // Create table cells and set their values
          const idCell = document.createElement('td');
          idCell.textContent = item.id;
          row.appendChild(idCell);

          const tempCell = document.createElement('td');
          tempCell.textContent = item.temperature;
          row.appendChild(tempCell);

          const humidityCell = document.createElement('td');
          humidityCell.textContent = item.humidity;
          row.appendChild(humidityCell);

          const waterLevelCell = document.createElement('td');
          waterLevelCell.textContent = item.waterlevel;
          row.appendChild(waterLevelCell);

          const pressureCell = document.createElement('td');
          pressureCell.textContent = item.pressure;
          row.appendChild(pressureCell);

          const batteryCell = document.createElement('td');
          batteryCell.textContent = item.battery;
          row.appendChild(batteryCell);

          const readingIdCell = document.createElement('td');
          readingIdCell.textContent = item.readingId;
          row.appendChild(readingIdCell);

          // Append the row to the table body
          tableBody.appendChild(row);
        });
      });
  }

  // Call the fetchData function to populate the table
  fetchData();

  function updateTime() {
        var date = new Date();
        var options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        var dateTimeString = date.toLocaleDateString(undefined, options) + " " + date.toLocaleTimeString();
        document.getElementById("timeSpan").innerText = dateTimeString;
    }


    // Update the time every second
    setInterval(updateTime, 1000);

  var webVoltage;
  setInterval(function () {
    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function () {
      if (this.readyState == 4 && this.status == 200) {
        webVoltage = parseFloat(this.responseText);
        // $('#webVoltage').html(webVoltage + '%');
        // Update the HTML element with the ID "board3Voltage"
        var el = document.getElementById("board3Voltage");
        if (el != null) {
          el.innerHTML = webVoltage;
        } else {
          console.error("Element with ID 'board3Voltage' not found");
        }
      }
    };
    xhttp.open("GET", "/webVoltage", true);
    xhttp.send();
  }, 60000);
  // Code for Map
  function initMap() {
        var source = new EventSource('/events');
        var sensorData = ""; // Define sensorData variable outside of the event listener
        var sensorMarkers = []; // Array to store sensor markers
        var rangeCircle;

        var infowindow = new google.maps.InfoWindow(); // Declare the infowindow variable outside the event listener

        source.addEventListener('open', function (e) {
            console.log("Events Connected");
        }, false);
        source.addEventListener('error', function (e) {
            if (e.target.readyState != EventSource.OPEN) {
                console.log("Events Disconnected");
            }
        }, false);

        source.addEventListener('message', function (e) {
            // console.log("message", e.data);
        }, false);

        var map = new google.maps.Map(document.getElementById("map"), {
            center: { lat: 14.440703903499237, lng: 120.92957878388968 }, // Target coordinates
            zoom: 17, // Zoom level
            styles: [{
                featureType: 'poi',
                stylers: [{ visibility: 'off' }] // Hide Points of Interest (POI) markers
            }
                // Add more style rules as needed to customize the map appearance
            ]
        });

        // Function to create a sensor marker
        function createSensorMarker(sensorLatLng, title, sensorId, rangeRadius, initialColor) {
            var marker = new google.maps.Marker({
                position: sensorLatLng,
                map: map,
                title: title,
                animation: google.maps.Animation.DROP,
                label: {
                    text: title,
                    color: '#404040',
                    fontWeight: 'bold',
                    labelOrigin: new google.maps.Point(0, 32)
                }
            });

            var rangeCircle = new google.maps.Circle({
                strokeColor: "gray",
                strokeOpacity: 0.8,
                fillColor: initialColor,
                strokeWeight: 2,
                fillColor: "green",
                fillOpacity: 0.35,
                center: sensorLatLng,
                radius: rangeRadius,
                map: map
            });

            marker.addListener("click", function () {
                var sensorData = sensorMarkers[sensorId].data;
                var infowindow = new google.maps.InfoWindow({
                    content: "Sensor ID: " + sensorId +
                        "<br>Water Level: " + sensorData.waterlevel.toFixed(2) +
                        "<br>Pressure: " + sensorData.pressure.toFixed(2) +
                        "<br>Temperature: " + sensorData.temperature.toFixed(2) +
                        "<br>Humidity: " + sensorData.humidity.toFixed(2) +
                        "<br>Battery Level: " + sensorData.batteryLevel.toFixed(2) + "%"
                });
                infowindow.open(map, marker);
            });

            sensorMarkers[sensorId] = { marker: marker, rangeCircle: rangeCircle, data: {} };
        }

        // Create the first sensor marker
        var sensor1LatLng = { lat: 14.440703903499237, lng: 120.92957878388968 }; // Replace with actual sensor location
        createSensorMarker(sensor1LatLng, "Toclong II St.", 3, 85, "green");

        // Create the second sensor marker
        // var sensor2LatLng = { lat: 14.438773, lng: 120.929984 }; // Replace with actual sensor location
        // createSensorMarker(sensor2LatLng, "E. Villanueva Ave.", 2, 85, "green");

        // // Create the third sensor marker
        // var sensor3LatLng = { lat: 14.440837, lng: 120.930466 }; // Replace with actual sensor location
        // createSensorMarker(sensor3LatLng, "Tributary River", 1, 50, "green");

        function updateRangeCircle(centerLatLng, radius) {
            if (rangeCircle) {
                rangeCircle.setMap(null); // Remove the existing range circle
            }
            rangeCircle = new google.maps.Circle({
                strokeColor: "gray",
                strokeOpacity: 0.8,
                strokeWeight: 2,
                fillColor: "green",
                fillOpacity: 0.35,
                center: centerLatLng,
                radius: radius,
                map: map
            });
        }

        source.addEventListener('new_readings', function (e) {
            // console.log("new_readings", e.data);
            var obj = JSON.parse(e.data);
            if (obj.id === 1) {

                sensorMarkers[1].data = {
                    waterlevel: obj.waterlevel,
                    pressure: obj.pressure,
                    temperature: obj.temperature,
                    humidity: obj.humidity,
                    batteryLevel: webVoltage
                };

                // Update the range circle color based on the water level for sensor 1
                if (obj.pressure >= 10 && obj.pressure <= 15) {
                    sensorMarkers[1].rangeCircle.setOptions({ fillColor: "orange" });
                } else if (obj.pressure > 15 && obj.pressure <= 200) {
                    sensorMarkers[1].rangeCircle.setOptions({ fillColor: "red" });
                } else {
                    sensorMarkers[1].rangeCircle.setOptions({ fillColor: "green" });
                }
            } else if (obj.id === 2) {
                sensorMarkers[2].data = {
                    waterlevel: obj.waterlevel,
                    pressure: obj.pressure,
                    temperature: obj.temperature,
                    humidity: obj.humidity,
                    batteryLevel: webVoltage
                };
                // Update the range circle color based on the water level for sensor 2
                if (obj.pressure >= 10 && obj.pressure <= 15) {
                    sensorMarkers[2].rangeCircle.setOptions({ fillColor: "orange" });
                } else if (obj.pressure > 15 && obj.pressure <= 200) {
                    sensorMarkers[2].rangeCircle.setOptions({ fillColor: "red" });
                } else {
                    sensorMarkers[2].rangeCircle.setOptions({ fillColor: "green" });
                }
            } else if (obj.id === 3) {
                sensorMarkers[3].data = {
                    waterlevel: obj.waterlevel,
                    pressure: obj.pressure,
                    temperature: obj.temperature,
                    humidity: obj.humidity,
                    batteryLevel: webVoltage
                };
                // Update the range circle color based on the water level for sensor 3
                if (obj.pressure >= 10 && obj.pressure <= 15) {
                    sensorMarkers[3].rangeCircle.setOptions({ fillColor: "orange" });
                } else if (obj.pressure > 15 && obj.pressure <= 200) {
                    sensorMarkers[3].rangeCircle.setOptions({ fillColor: "red" });
                } else {
                    sensorMarkers[3].rangeCircle.setOptions({ fillColor: "green" });
                }
            }
        }, false);
    }

    window.jsPDF = window.jspdf.jsPDF
    // Event listener for the download button
    // Event listener for the download button
    document.getElementById('download-btn').addEventListener('click', function () {
        // Capture the web page using html2canvas
        html2canvas(document.body, {
            scrollY: -window.scrollY, // Capture the entire page by scrolling
            windowWidth: document.documentElement.offsetWidth, // Set the width of the captured screenshot
            windowHeight: document.documentElement.offsetHeight, // Set the height of the captured screenshot
            useCORS: true // Enable CORS to capture images from external sources
        }).then(function (canvas) {
            var imgData = canvas.toDataURL('image/png');
            var doc = new jsPDF('landscape'); // Set the orientation to landscape
            var pdfWidth = doc.internal.pageSize.getWidth();
            var pdfHeight = doc.internal.pageSize.getHeight();
            var imgHeight = (canvas.height * pdfWidth) / canvas.width;
            var remainingHeight = imgHeight;

            var pageHeight = pdfHeight - 20; // Adjust the margin to suit your needs

            // Calculate the number of required pages
            var numPages = Math.ceil(imgHeight / pageHeight);

            for (var pageNumber = 0; pageNumber < numPages; pageNumber++) {
                if (pageNumber > 0) {
                    doc.addPage();
                }
                var heightPosition = -pageNumber * pageHeight;
                doc.addImage(imgData, 'PNG', 0, heightPosition, pdfWidth, imgHeight, null, 'FAST');
            }

            // Generate a unique name for the PDF file using the current date and time
            var now = new Date();
            var fileName = 'FLOOD-ALERT-B3-REPORT_' + now.toLocaleDateString().replace(/\//g, '-') + '_' + now.toLocaleTimeString().replace(/:/g, '');

            // Download the PDF with the generated file name
            doc.save(fileName + '.pdf');
        });
    });
  //Code for data tables
  if (!!window.EventSource) {
    var source = new EventSource('/events');
    source.addEventListener('open', function (e) {
      console.log("Events Connected");
    }, false);
    source.addEventListener('error', function (e) {
      if (e.target.readyState != EventSource.OPEN) {
        console.log("Events Disconnected");
      }
    }, false);
    source.addEventListener('message', function (e) {
      // console.log("message", e.data);
    }, false);
    source.addEventListener('new_readings', function (e) {
      // console.log("new_readings", e.data);
      var obj = JSON.parse(e.data);
      // Update card body text based on water level
      var cardTitle = document.getElementById("na" + obj.id);
      var cardText = document.getElementById("nb" + obj.id);
      var waterLevel = obj.pressure.toFixed(2);
      if (waterLevel >= 10 && waterLevel <= 15) {
        cardTitle.innerHTML = "NPLV";
        cardText.innerHTML = "(Non-Passable for Light Vehicles)";
      } else if (waterLevel > 15 && waterLevel <= 20) {
        cardTitle.innerHTML = "NPATV";
        cardText.innerHTML = "(Non-Passable for All Types of Vehicles)";
      } else {
        cardTitle.innerHTML = "PATV";
        cardText.innerHTML = "(Passable for All Types of Vehicles)";
      }
      // document.getElementById(webVoltage).innerHTML = webVoltage;
      document.getElementById("t" + obj.id).innerHTML = obj.temperature.toFixed(2);
      document.getElementById("h" + obj.id).innerHTML = obj.humidity.toFixed(2);
      document.getElementById("w" + obj.id).innerHTML = obj.waterlevel.toFixed(2);
      document.getElementById("p" + obj.id).innerHTML = obj.pressure.toFixed(2);
      document.getElementById("rw" + obj.id).innerHTML = obj.readingId;
      document.getElementById("rp" + obj.id).innerHTML = obj.readingId;
      document.getElementById("rt" + obj.id).innerHTML = obj.readingId;
      document.getElementById("rh" + obj.id).innerHTML = obj.readingId;
    }, false);
  }
  // Board 3
  var chartP3 = new Highcharts.Chart({
    chart: {
      renderTo: 'chart-pressure3'
    },
    title: {
      text: 'Water Level (Pressure)'
    },
    series: [{
      showInLegend: false,
      data: []
    }],
    plotOptions: {
      line: {
        animation: false,
        dataLabels: {
          enabled: true
        }
      },
      series: {
        color: '#18009c'
      }
    },
    xAxis: {
      type: 'datetime',
      dateTimeLabelFormats: {
        second: '%H:%M:%S'
      }
    },
    yAxis: {
      title: {
        text: 'Measured through Pressure (cm)',
        min: 0,   // Minimum value for the Y-axis
        max: 150  // Maximum value for the Y-axis
      }
    },
    credits: {
      enabled: false
    }
  });
  setInterval(function () {
    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function () {
      if (this.readyState == 4 && this.status == 200) {
        var x = (new Date()).getTime(),
          y = parseFloat(this.responseText);
        //console.log(this.responseText);
        if (chartP3.series[0].data.length > 10) {
          chartP3.series[0].addPoint([x, y], true, true, true);
        } else {
          chartP3.series[0].addPoint([x, y], true, false, true);
        }
      }
    };
    xhttp.open("GET", "/pressureB3", true);
    xhttp.send();
  }, 2500);
  var chartL3 = new Highcharts.Chart({
    chart: {
      renderTo: 'chart-level3'
    },
    title: {
      text: 'Water level (Ultrasonic)'
    },
    series: [{
      showInLegend: false,
      data: []
    }],
    plotOptions: {
      line: {
        animation: false,
        dataLabels: {
          enabled: true
        }
      },
      series: {
        color: '#18009c'
      }
    },
    xAxis: {
      type: 'datetime',
      dateTimeLabelFormats: {
        second: '%H:%M:%S'
      }
    },
    yAxis: {
      title: {
        text: 'Measured through Ultrasonic (cm)',
        min: 0,   // Minimum value for the Y-axis
        max: 0  // Maximum value for the Y-axis
      }
    },
    credits: {
      enabled: false
    }
  });
  setInterval(function () {
    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function () {
      if (this.readyState == 4 && this.status == 200) {
        var x = (new Date()).getTime(),
          y = parseFloat(this.responseText);
        //console.log(this.responseText);
        if (chartL3.series[0].data.length > 10) {
          chartL3.series[0].addPoint([x, y], true, true, true);
        } else {
          chartL3.series[0].addPoint([x, y], true, false, true);
        }
      }
    };
    xhttp.open("GET", "/waterlevelB3", true);
    xhttp.send();
  }, 2500);
  var chartT3 = new Highcharts.Chart({
    chart: {
      renderTo: 'chart-temperature3'
    },
    title: {
      text: 'Temperature'
    },
    series: [{
      showInLegend: false,
      data: []
    }],
    plotOptions: {
      line: {
        animation: false,
        dataLabels: {
          enabled: true
        }
      },
      series: {
        color: '#059e8a'
      }
    },
    xAxis: {
      type: 'datetime',
      dateTimeLabelFormats: {
        second: '%H:%M:%S'
      }
    },
    yAxis: {
      title: {
        text: 'Temperature (Celsius)',
        min: 20,   // Minimum value for the Y-axis
        max: 50  // Maximum value for the Y-axis
      }
      //title: { text: 'Temperature (Fahrenheit)' }
    },
    credits: {
      enabled: false
    }
  });
  setInterval(function () {
    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function () {
      if (this.readyState == 4 && this.status == 200) {
        var x = (new Date()).getTime(),
          y = parseFloat(this.responseText);
        //console.log(this.responseText);
        if (chartT3.series[0].data.length > 10) {
          chartT3.series[0].addPoint([x, y], true, true, true);
        } else {
          chartT3.series[0].addPoint([x, y], true, false, true);
        }
      }
    };
    xhttp.open("GET", "/temperatureB3", true);
    xhttp.send();
  }, 2500);
  var chartH3 = new Highcharts.Chart({
    chart: {
      renderTo: 'chart-humidity3'
    },
    title: {
      text: 'Humidity'
    },
    series: [{
      showInLegend: false,
      data: []
    }],
    plotOptions: {
      line: {
        animation: false,
        dataLabels: {
          enabled: true
        }
      }
    },
    xAxis: {
      type: 'datetime',
      dateTimeLabelFormats: {
        second: '%H:%M:%S'
      }
    },
    yAxis: {
      title: {
        text: 'Humidity (%)',
        min: 0,   // Minimum value for the Y-axis
        max: 100  // Maximum value for the Y-axis

      }
    },
    credits: {
      enabled: false
    }
  });
  setInterval(function () {
    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function () {
      if (this.readyState == 4 && this.status == 200) {
        var x = (new Date()).getTime(),
          y = parseFloat(this.responseText);
        //console.log(this.responseText);
        if (chartH3.series[0].data.length > 10) {
          chartH3.series[0].addPoint([x, y], true, true, true);
        } else {
          chartH3.series[0].addPoint([x, y], true, false, true);
        }
      }
    };
    xhttp.open("GET", "/humidityB3", true);
    xhttp.send();
  }, 2500);
</script>
<script
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDvUX3PBWIUBWAWxRDUCGxdNJ7Q7GumFyo&callback=initMap"></script>

</html>